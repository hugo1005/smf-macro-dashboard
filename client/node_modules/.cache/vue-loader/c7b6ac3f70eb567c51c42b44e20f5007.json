{"remainingRequest":"/Users/hugo/Dropbox/hugo_documents_folder/SMF_RISK/dashboard/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hugo/Dropbox/hugo_documents_folder/SMF_RISK/dashboard/client/src/components/TreeChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hugo/Dropbox/hugo_documents_folder/SMF_RISK/dashboard/client/src/components/TreeChart.vue","mtime":1610142022247},{"path":"/Users/hugo/Dropbox/hugo_documents_folder/SMF_RISK/dashboard/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hugo/Dropbox/hugo_documents_folder/SMF_RISK/dashboard/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hugo/Dropbox/hugo_documents_folder/SMF_RISK/dashboard/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hugo/Dropbox/hugo_documents_folder/SMF_RISK/dashboard/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIGQzIGZyb20gImQzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHtyb3VuZCwgc3VtfSBmcm9tICdtYXRoanMnOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogInZ1ZS10cmVlLWNoYXJ0IiwKICAgIHByb3BzOiBbJ2RhdGEnLCdiYWNrZ3JvdW5kJywnaGlnaGxpZ2h0Jywnc2hvcnRfY2F0ZWdvcnknXSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbG9hZGluZzogdHJ1ZSwKICAgICAgICAgICAgcm9vdDoge30sCiAgICAgICAgICAgIGNoYXJ0RGVmYXVsdHM6IHsKICAgICAgICAgICAgICAgIHdpZHRoOiA4MDAsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDU1MCwKICAgICAgICAgICAgICAgIGNoYXJ0SWQ6ICJsaW5lY2hhcnQtdnVlIiwKICAgICAgICAgICAgICAgIG1hcmdpbjogewogICAgICAgICAgICAgICAgICAgIHRvcDogMCwKICAgICAgICAgICAgICAgICAgICByaWdodDogMCwKICAgICAgICAgICAgICAgICAgICBib3R0b206IDAsCiAgICAgICAgICAgICAgICAgICAgbGVmdDogMAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGdyaWRPcGFjaXR5OiAxLAogICAgICAgICAgICAgICAgZGF0YTogW10sCiAgICAgICAgICAgICAgICBwYWRkaW5nOiB7CiAgICAgICAgICAgICAgICAgICAgaW5uZXI6IDAsCiAgICAgICAgICAgICAgICAgICAgb3V0ZXI6IDIsCiAgICAgICAgICAgICAgICAgICAgdG9wOjIwLAogICAgICAgICAgICAgICAgICAgIGJvdHRvbTowCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxpbmU6ICIiLAogICAgICAgICAgICAvL1RyYW5zbGF0ZSBjby1vcmRzIGZvciBjaGFydCwgeCBheGlzIGFuZCB5YXhpcy4gVGhpcyBpcyBpbmplY3RlZCBpbnRvIHRlbXBsYXRlCiAgICAgICAgICAgIHRybnNZOiAidHJhbnNsYXRlKDAsMCkiLAogICAgICAgICAgICB0cm5zWDogdGhpcy5nZXRUcm5zeCwKICAgICAgICB9OwogICAgfSwgCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMudHJhbnNsYXRlID0gInRyYW5zbGF0ZSgiICsgdGhpcy5jaGFydERlZmF1bHRzLm1hcmdpbi5sZWZ0ICsgIiwiICsgdGhpcy5jaGFydERlZmF1bHRzLm1hcmdpbi50b3AgKyAiKSI7CiAgICAgICAgdGhpcy5jYWxjdWxhdGVUcmVlKCk7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgY2FsY3VsYXRlVHJlZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHRoaXMucm9vdCA9IGQzLmhpZXJhcmNoeSh0aGlzLmRhdGEpLnN1bShmdW5jdGlvbihkKXsgcmV0dXJuIGQucG9ydF93ZWlnaHR9KSAKICAgICAgICAgICAgZDMudHJlZW1hcCgpLnRpbGUoZDMudHJlZW1hcEJpbmFyeSkuc2l6ZShbdGhpcy5jaGFydERlZmF1bHRzLndpZHRoLHRoaXMuY2hhcnREZWZhdWx0cy5oZWlnaHRdKS5wYWRkaW5nSW5uZXIodGhpcy5jaGFydERlZmF1bHRzLnBhZGRpbmcuaW5uZXIpCiAgICAgICAgICAgIC5wYWRkaW5nT3V0ZXIodGhpcy5jaGFydERlZmF1bHRzLnBhZGRpbmcub3V0ZXIpLnBhZGRpbmdUb3AodGhpcy5jaGFydERlZmF1bHRzLnBhZGRpbmcudG9wKS5wYWRkaW5nQm90dG9tKHRoaXMuY2hhcnREZWZhdWx0cy5wYWRkaW5nLmJvdHRvbSkodGhpcy5yb290KTsKICAgICAgICB9LAogICAgICAgIGdldFNob3J0ZW5kZWRDYXRlZ29yeTogZnVuY3Rpb24oY2F0KSB7IAogICAgICAgICAgICBpZih0aGlzLnNob3J0X2NhdGVnb3J5KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaG9ydF9jYXRlZ29yeVtjYXRdCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY2F0CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgfSwKICAgICAgICBnZXRBdHRyaWJ1dGlvbkNvbG9yOiBmdW5jdGlvbihyX3Vuc2NhbGVkKSB7CiAgICAgICAgICAgIGlmKHJfdW5zY2FsZWQgPj0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuICcjODZBRDNCJwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuICcjQUQzQjNCJwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByb3VuZERhdGEoZCwgZGlnaXRzKSB7CiAgICAgICAgICAgIHJldHVybiByb3VuZChkLCBkaWdpdHMpCiAgICAgICAgfSwKICAgICAgICBnZXRGaWxsU3R5bGUoc19uYW1lLCByX25hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIHJfbmFtZSA9PSAnRVUnPyB7ZmlsbDondXJsKCMnK3NfbmFtZS5yZXBsYWNlKCcgJywnLScpKyctaCknfToge2ZpbGw6J3VybCgjJytzX25hbWUucmVwbGFjZSgnICcsJy0nKSArICcpJ30KICAgICAgICB9LAogICAgfQp9Owo="},{"version":3,"sources":["TreeChart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TreeChart.vue","sourceRoot":"src/components","sourcesContent":["<!-- \nGood example here bar chart ---[ https://stackoverflow.com/questions/48726636/draw-d3-axis-without-direct-dom-manipulation \n-->\n\n<template>\n    <div v-if=\"!loading\">\n        <!-- <h1><span v-bind:style={color:highlight[category]}>{{getShortendedCategory(category)}}</span>{{title}} <span class='float-right' v-if=\"show_pct\" :style=\"{color: getAttributionColor(getPctChange())}\">[{{getPctChange()}} %]</span></h1> -->\n        <svg :width=\"chartDefaults.width + chartDefaults.margin.left + chartDefaults.margin.right\" :height=\"chartDefaults.height + chartDefaults.margin.top + chartDefaults.margin.bottom\">\n        <g v-for=\"s_child in root.children\" :key=\"s_child.data.name\">\n            <defs>\n            <linearGradient :id=\"s_child.data.name.replace(' ','-')\" gradientTransform=\"rotate(90)\">\n            <stop offset=\"0%\" :stop-color=\"background[s_child.data.name]+'60'\"/>\n            <stop offset=\"100%\" :stop-color=\"background[s_child.data.name]\"/>\n            </linearGradient>\n            <linearGradient :id=\"s_child.data.name.replace(' ','-')+'-h'\" gradientTransform=\"rotate(90)\">\n            <stop offset=\"0%\" :stop-color=\"highlight[s_child.data.name]+'60'\"/>\n            <stop offset=\"100%\" :stop-color=\"highlight[s_child.data.name]\"/>\n            </linearGradient>\n            </defs>\n            <!--   -->\n\n            <rect v-if=\"s_child.data.port_sector_weight > 0\"\n                :x=\"s_child.x0\" \n                :y=\"s_child.y0\" \n                :width=\"s_child.x1 - s_child.x0\" \n                :height=\"s_child.y1 - s_child.y0\"\n                :fill=\"background[s_child.data.name]+'30'\"\n                >\n            </rect>\n            \n            <g v-for=\"r_child in s_child.children\" :key=\"r_child.data.name + s_child.data.name\">\n                \n\n                <g v-if=\"r_child.data.port_weight > 0\">\n                    <rect\n                    :x=\"r_child.x0\" \n                    :y=\"r_child.y0\" \n                    :width=\"r_child.x1 - r_child.x0\" \n                    :height=\"r_child.y1 - r_child.y0\"\n                    :style=\"getFillStyle(s_child.data.name,r_child.data.name)\" \n                    >\n                    </rect>\n\n                    <g v-for=\"e_child in r_child.children\" :key=\"e_child.data.name\">\n                        <rect\n                        :x=\"e_child.x0\" \n                        :y=\"e_child.y0\" \n                        :width=\"(e_child.x1 - e_child.x0)\" \n                        :height=\"e_child.y1 - e_child.y0\"\n                        stroke='#ffffff30'\n                        fill=none\n                        >\n                        </rect>\n\n                        <text \n                        :x=\"e_child.x0 + 5\" \n                        :y=\"e_child.y0 + 10\" \n                        font-size=\"10\"\n                        text-anchor='left'\n                        dominant-baseline='middle'\n                        fill='#ffffff30' \n                        >\n                        {{e_child.data.name}}\n                        </text>\n\n                        <text \n                        :x=\"e_child.x1 - 5\" \n                        :y=\"e_child.y1 - 10\" \n                        font-size=\"10\"\n                        text-anchor='end'\n                        dominant-baseline='middle'\n                        fill='#ffffff30' \n                        >\n                        {{roundData(e_child.data.port_weight * 100,2)}} % \n                        </text>\n                    </g>\n\n                    <text \n                        text-anchor='left' \n                        dominant-baseline='middle' \n                        :x=\"r_child.x0 + 5\" \n                        :y=\"r_child.y0 + 10\" \n                        fill='#ffffff80'  \n                        font-size=\"10\">\n                        {{r_child.data.name}} ({{roundData(r_child.data.port_weight * 100,2)}} %)\n                    </text>\n                </g>\n                \n            </g>\n            <text v-if=\"s_child.data.port_sector_weight > 0\"\n                :x=\"s_child.x0 + chartDefaults.padding.outer + 5\" \n                :y=\"s_child.y0 + chartDefaults.padding.top/2\" \n                :fill='highlight[s_child.data.name]' \n                font-size=\"10\"\n                dominant-baseline='middle'\n            >\n                {{getShortendedCategory(s_child.data.name)}} ({{roundData(s_child.data.port_sector_weight * 100,2)}} %)\n            </text>\n\n            <text v-if=\"s_child.data.port_sector_weight > 0\"\n                text-anchor='end' \n                dominant-baseline='middle' \n                :x=\"s_child.x1 - 5\" \n                :y=\"s_child.y0 + 10\" \n                :fill='getAttributionColor(s_child.data.benchmark_deviation)'  \n                font-size=\"10\">\n                [{{roundData((s_child.data.benchmark_deviation) * 100,2)}} %]\n            </text>\n        </g>\n        </svg>\n    </div>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport axios from 'axios';\nimport {round, sum} from 'mathjs';\n\nexport default {\n    name: \"vue-tree-chart\",\n    props: ['data','background','highlight','short_category'],\n    data() {\n        return {\n            loading: true,\n            root: {},\n            chartDefaults: {\n                width: 800,\n                height: 550,\n                chartId: \"linechart-vue\",\n                margin: {\n                    top: 0,\n                    right: 0,\n                    bottom: 0,\n                    left: 0\n                },\n                gridOpacity: 1,\n                data: [],\n                padding: {\n                    inner: 0,\n                    outer: 2,\n                    top:20,\n                    bottom:0\n                }\n            },\n            line: \"\",\n            //Translate co-ords for chart, x axis and yaxis. This is injected into template\n            trnsY: \"translate(0,0)\",\n            trnsX: this.getTrnsx,\n        };\n    }, \n    created() {\n        this.translate = \"translate(\" + this.chartDefaults.margin.left + \",\" + this.chartDefaults.margin.top + \")\";\n        this.calculateTree();\n        this.loading = false\n    },\n    methods: {\n        calculateTree: function() {\n            this.root = d3.hierarchy(this.data).sum(function(d){ return d.port_weight}) \n            d3.treemap().tile(d3.treemapBinary).size([this.chartDefaults.width,this.chartDefaults.height]).paddingInner(this.chartDefaults.padding.inner)\n            .paddingOuter(this.chartDefaults.padding.outer).paddingTop(this.chartDefaults.padding.top).paddingBottom(this.chartDefaults.padding.bottom)(this.root);\n        },\n        getShortendedCategory: function(cat) { \n            if(this.short_category) {\n                return this.short_category[cat]\n            } else {\n                return cat\n            }\n            \n        },\n        getAttributionColor: function(r_unscaled) {\n            if(r_unscaled >= 0) {\n                return '#86AD3B'\n            } else {\n                return '#AD3B3B'\n            }\n        },\n        roundData(d, digits) {\n            return round(d, digits)\n        },\n        getFillStyle(s_name, r_name) {\n            return r_name == 'EU'? {fill:'url(#'+s_name.replace(' ','-')+'-h)'}: {fill:'url(#'+s_name.replace(' ','-') + ')'}\n        },\n    }\n};\n</script>\n<!-- css loaderhttps://vue-loader.vuejs.org/guide/scoped-css.html#mixing-local-and-global-styles -->\n<style>\nh1 {\n    color: white;\n    font-family: Roboto;\n    font-size: 10px;\n    text-align: left;\n    padding-left: 10px;\n    padding-bottom: 5px;\n    padding-top: 5px;\n    margin-top:0px;\n    background: #b23d3d30;\n}\n\nh1 span {\n    margin-right: 10px;\n}\n\npath.line {\n  fill: none;\n  stroke: white;\n  stroke-width: 1px;\n}\n\n.grid line {\n  opacity: 0.05;\n  color:white;\n}\n.xA line {\n  opacity: 0.5;\n}\n\n.xA {\n    color:white;\n}\n\n.yA {\n    color:white;\n}\n\n/*Some fancy animation to draw chart*/\n/* svg .lineChart > path {\n  stroke: #ecbc3a;\n  stroke-width: 3;\n  stroke-dasharray: 4813.713;\n  stroke-dashoffset: 4813.713;\n}\n\n.ani2 svg .lineChart > path {\n  stroke: #ecbc3a;\n}\n.ani1 svg .lineChart > path {\n  stroke: #ecbc3a;\n} */\n\n#Layer_1 {\n  width: 100%;\n}\n\n.text {\n  display: inline-block;\n  font-size: 3vw;\n  margin: 0.5vw 0 1.5vw;\n}\n\nsvg {\n  border-bottom: 1px solid rgba(256,256,256,0.1);\n  margin-bottom: 0;\n}\n\n.float-right {\n    float: right;\n}\n</style>\n"]}]}